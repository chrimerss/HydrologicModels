% HyModMain.m% Matlab Script file to run the HyMod Model % using Leaf River Data% 9/18/05 written by Hoshin Gupta for HWR 521%--------------------------------------------------------------------------% DATA STRUCTURE%   Data.PP = Precipitation flux (mm/day)%   Data.PET = Potential Evapo-Transpiration flux (mm/day)%   Data.QQ = Streamflow flux (mm/day)% PARAMETER STRUCTURE%   Pars.Huz = Max height of soil moisture accounting tank - Range [0, Inf]%   Pars.B   = Distribution function shape parameter       - Range [0, 2]%   Pars.Alp = Quick-slow split parameter                  - Range [0, 1];%   Pars.Nq  = Number of quickflow routing tanks           - Range [1, Inf]%   Pars.Kq  = Quickflow routing tanks rate parameter      - Range [0, 1]%   Pars.Ks  = Slowflow routing tanks rate parameter       - Range [0, 1]% Initialize state variables%   InState.XCuz = Soil moisture accounting tank state contents - Dim(1 x 1)%   InState.Xq   = Quickflow routing tanks state contents - Dim(1 x Pars.nq)%   InState.Xs   = Slowflow routing tank state contents - Dim (1 x 1)% MODEL STRUCTURE%   Model.XHuz = Model computed upper zone soil moisture tank state contents%   Model.XCuz = Model computed upper zone soil moisture tank state contents%   Model.Xq   = Model computed quickflow tank states contents%   Model.Xs   = Model computed slowflow tank state contents%   Model.ET   = Model computed evapotranspiration flux%   Model.OV   = Model computed precipitation excess flux%   Model.Qq   = Model computed quickflow flux%   Model.Qs   = Model computed slowflow flux%   Model.Q    = Model computed total streamflow flux    %--(1)--Initialization    clear;                      % clear the workspace    close all;                  % close all open windows% Load data        load LeafCatch.dat;         % load the data file named 'LeafCatch.dat' into array 'LeafCatch'    Data.PP  = LeafCatch(:,1);       Data.PET = LeafCatch(:,2);      Data.QQ  = LeafCatch(:,3);       Ndays    = length(Data.PP);          % Assign model parameter values%     Pars.Huz = 100;              %     Pars.B   = 1.5;             %     Pars.Alp = 0.85;            %     Pars.Nq  = 3;               %     Pars.Kq  = 0.75;             %     Pars.Ks  = 0.01;        Pars.Huz = 373.87;                  Pars.B   = 1.133;                 Pars.Alp = 0.2917;                Pars.Nq  = 3;                   Pars.Kq  = 0.79;                 Pars.Ks  = 0.2814;           % Initialize state variables    InState.XCuz = 0;                   InState.Xq   = zeros(1,Pars.Nq);     InState.Xs   = 0;                %--(2)--Select Period to Simulate        Text = ['Number of days of data available = ',num2str(Ndays)];    disp(Text);    DayFirst = 1;      DayLast  = 365*10;    if DayFirst > DayLast; error('Error ... DayFirst > DayLast'); end;     if DayLast > Ndays; error('Error ... Not enough days of data in file'); end;    Period = [DayFirst:DayLast]'; %--(3)--Run Model for Simulation Period    Model = Hymod01(Data, Period, Pars, InState);%--(4)--Plot Results    Results(Period, Data, Model, Pars);    % End Script HyModMain